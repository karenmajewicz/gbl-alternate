
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://karenmajewicz.github.io/gbl-mkdocs/docs/upgrading/Upgrading_to_version_2_0/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15+insiders-4.35.3">
    
    
      
        <title>Upgrading to version 2 0 - GBL MkDocs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.cac7c1ad.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc776e4.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/neoteroi-cards.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#upgrading-to-geoblacklight-20" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="GBL MkDocs" class="md-header__button md-logo" aria-label="GBL MkDocs" data-md-component="logo">
      
  <img src="../../../images/geoblacklight-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GBL MkDocs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrading to version 2 0
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../showcase/" class="md-tabs__link">
          
  
    
  
  Showcase

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../connect/" class="md-tabs__link">
        
  
    
  
  Connect

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://geoblacklight.org/docs" class="md-tabs__link">
        
  
    
  
  Documentation

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="GBL MkDocs" class="md-nav__button md-logo" aria-label="GBL MkDocs" data-md-component="logo">
      
  <img src="../../../images/geoblacklight-logo.png" alt="logo">

    </a>
    GBL MkDocs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../showcase/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Showcase
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Showcase
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Connect
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../blog/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2021
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2019
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2018
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2017
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2016/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2016
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2015/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    2015
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/releases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    releases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/sprints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    sprints
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    tutorials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://geoblacklight.org/docs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrading-to-geoblacklight-20" class="md-nav__link">
    <span class="md-ellipsis">
      
        Upgrading to GeoBlacklight 2.0
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Upgrading to GeoBlacklight 2.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blacklight-7-upgrades" class="md-nav__link">
    <span class="md-ellipsis">
      
        Blacklight 7 upgrades
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Blacklight 7 upgrades">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-user-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update User Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-catalogcontroller" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update CatalogController
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webpacker" class="md-nav__link">
    <span class="md-ellipsis">
      
        Webpacker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-webpacker" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Webpacker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Webpacker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-packs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding packs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-webpack-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Webpack server
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geoblacklight-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        GeoBlacklight updates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GeoBlacklight updates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dropped-leaflet-rails-vendorized-a-rails-savvy-leafletjs-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dropped leaflet-rails; Vendorized a rails-savvy leaflet.js file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#added-spatial-search-bbox-overlapratio-relevancy-option" class="md-nav__link">
    <span class="md-ellipsis">
      
        Added Spatial Search BBox overlapRatio Relevancy Option
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relevancy-is-best-tuned-locally" class="md-nav__link">
    <span class="md-ellipsis">
      
        Relevancy is Best Tuned Locally
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#homepage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Homepage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Upgrading to version 2 0</h1>

<h2 id="upgrading-to-geoblacklight-20">Upgrading to GeoBlacklight 2.0</h2>
<p>While we suggest using the latest version of GeoBlacklight to take advantage of its modern features, sometimes you need to upgrade to an older release. GeoBlacklight 2.0 adds support for <a href="https://github.com/projectblacklight/blacklight/releases/tag/v7.0.0">Blacklight 7.0</a>, which itself includes several significant component upgrades:</p>
<ul>
<li><a href="https://getbootstrap.com/docs/4.0/getting-started/introduction/">Bootstrap 4</a></li>
<li><a href="https://guides.rubyonrails.org/5_2_release_notes.html">Rails 5.2</a> support</li>
<li>Webpacker support (see below)</li>
<li>JSON-API support</li>
<li>Solr 7.2+ support</li>
</ul>
<p>The Bootstrap 3 to Bootstrap 4 migration will require existing GeoBlacklight installations to update any local view or layout customizations they have created. See the <a href="https://github.com/projectblacklight/blacklight/wiki/Bootstrap-3-to-4-Migration-Guide">Blacklight guide on updating Bootstrap</a> for additional assistance.</p>
<h3 id="blacklight-7-upgrades">Blacklight 7 upgrades</h3>
<h4 id="update-user-model">Update User Model</h4>
<p>With the release of Blacklight 7, the <code>Blacklight::Utils</code> Module has been deprecated.  <code>User</code> Models must have the following removed:
  <div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">User</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="no">ApplicationRecord</span>
<span class="w">  </span><span class="c1">## Please remove or comment this code:</span>
<span class="w">  </span><span class="c1">##</span>
<span class="w">  </span><span class="c1"># if Blacklight::Utils.needs_attr_accessible?</span>
<span class="w">  </span><span class="c1">#   attr_accessible :email, :password, :password_confirmation</span>
<span class="w">  </span><span class="c1"># end</span>

<span class="w">  </span><span class="c1"># Connects this user object to Blacklights Bookmarks.</span>
<span class="w">  </span><span class="kp">include</span><span class="w"> </span><span class="no">Blacklight</span><span class="o">::</span><span class="no">User</span>
<span class="w">  </span><span class="c1"># Include default devise modules. Others available are:</span>
<span class="w">  </span><span class="c1"># :confirmable, :lockable, :timeoutable, :trackable and :omniauthable</span>
<span class="w">  </span><span class="n">devise</span><span class="w"> </span><span class="ss">:database_authenticatable</span><span class="p">,</span><span class="w"> </span><span class="ss">:registerable</span><span class="p">,</span>
<span class="w">         </span><span class="ss">:recoverable</span><span class="p">,</span><span class="w"> </span><span class="ss">:rememberable</span><span class="p">,</span><span class="w"> </span><span class="ss">:validatable</span>

<span class="w">  </span><span class="c1"># Method added by Blacklight; Blacklight uses #to_s on your</span>
<span class="w">  </span><span class="c1"># user class to get a user-displayable login/identifier for</span>
<span class="w">  </span><span class="c1"># the account.</span>
<span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">to_s</span>
<span class="w">    </span><span class="n">email</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div></p>
<h4 id="update-catalogcontroller">Update CatalogController</h4>
<p>Release 2.0 provides the ability to request JSON representations of Solr Documents by using the  path <code>/catalog/:id/raw</code> In other words, append <code>/raw</code> to the end of a catalog URL stem. Note that this is different from previous versions of GeoBlacklight and is a result of Blacklight 7 incorporating a <a href="https://jsonapi.org">JSON:API compliant</a> specification. Appending <code>.json</code> to the end of a catalog URL stem will now return a JSON:API compliant record, which is nested and not Solr compatible. For more information, see the <a href="https://opengeometadata.org/view-solr-metadata/">metadata documentation</a>.</p>
<p>The JSON record return is enabled within the <code>CatalogController</code> by setting <code>config.raw_endpoint.enabled</code> to <code>true</code>:
  <div class="highlight"><pre><span></span><code><span class="w">  </span><span class="n">configure_blacklight</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">config</span><span class="o">|</span>

<span class="w">    </span><span class="c1"># Ensures that JSON representations of Solr Documents can be retrieved using</span>
<span class="w">    </span><span class="c1"># the path /catalog/:id/raw</span>
<span class="w">    </span><span class="c1"># Please see https://github.com/projectblacklight/blacklight/pull/2006/</span>
<span class="w">    </span><span class="n">config</span><span class="o">.</span><span class="n">raw_endpoint</span><span class="o">.</span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">true</span>

<span class="w">    </span><span class="c1">## Default parameters to send to solr for all search-like requests. See also SolrHelper#solr_search_params</span>
<span class="w">    </span><span class="c1">## @see https://lucene.apache.org/solr/guide/6_6/common-query-parameters.html</span>
<span class="w">    </span><span class="c1">## @see https://lucene.apache.org/solr/guide/6_6/the-dismax-query-parser.html#TheDisMaxQueryParser-Theq.altParameter</span>
<span class="w">    </span><span class="n">config</span><span class="o">.</span><span class="n">default_solr_params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</code></pre></div></p>
<h4 id="webpacker">Webpacker</h4>
<p>Rails currently offers the ability for one to manage JavaScript source files and package dependencies using the <a href="https://github.com/rails/webpacker">Webpacker Gem</a>.  By default, this is available for usage in GeoBlacklight, but not enabled.</p>
<h4 id="requirements">Requirements</h4>
<p>Webpacker requires that either <a href="https://yarnpkg.com/">Yarn</a> or the <a href="https://www.npmjs.com/">Node Package Manager</a> be installed in the environment where the GeoBlacklight implementation is deployed.</p>
<h4 id="installing-webpacker">Installing Webpacker</h4>
<p>From within the root directory path of the GeoBlacklight application, please execute the following:
  <div class="highlight"><pre><span></span><code>bundle exec rails generate geoblacklight:webpacker --force
</code></pre></div></p>
<p>This will create a number of directories and files, most notably:
  - <code>package.json</code>
  - <code>app/javascript/packs/application.js</code></p>
<p>Running <code>yarn install</code> or <code>npm install</code>, followed by <code>yarn upgrade</code>/<code>npm update</code> would be best in order to install and update any JavaScript dependencies.</p>
<h5 id="adding-packs">Adding packs</h5>
<p>In order to add JavaScript packs to a GeoBlacklight application, one should override the view template <code>app/views/layouts/blacklight/base.html.erb</code> (provided in https://github.com/projectblacklight/blacklight/blob/v7.0.1/app/views/layouts/blacklight/base.html.erb) with the following line:
  <div class="highlight"><pre><span></span><code><span class="w">    </span><span class="o">&lt;</span><span class="sx">%= javascript_include_tag &quot;application&quot; %&gt;</span>
<span class="sx">    &lt;%=</span><span class="w"> </span><span class="n">javascript_pack_tag</span><span class="w"> </span><span class="s1">&#39;application&#39;</span><span class="w"> </span><span class="sx">%&gt;</span>
<span class="sx">    &lt;%= csrf_meta_tags %&gt;</span>
<span class="w">    </span><span class="o">&lt;%=</span><span class="w"> </span><span class="n">content_for</span><span class="p">(</span><span class="ss">:head</span><span class="p">)</span><span class="w"> </span><span class="sx">%&gt;</span>
<span class="sx">  &lt;/head&gt;</span>
</code></pre></div></p>
<p>For any new JS file added to <code>app/javascript/packs</code>, this will need to be added with a different name.  For example, <code>app/javascript/packs/my_new_script.js</code> would be added with:
  <div class="highlight"><pre><span></span><code><span class="w">    </span><span class="o">&lt;</span><span class="sx">%= javascript_include_tag &quot;application&quot; %&gt;</span>
<span class="sx">    &lt;%=</span><span class="w"> </span><span class="n">javascript_pack_tag</span><span class="w"> </span><span class="s1">&#39;application&#39;</span><span class="w"> </span><span class="sx">%&gt;</span>
<span class="sx">    &lt;%= javascript_pack_tag &#39;my_new_script&#39; %&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="sx">%= csrf_meta_tags %&gt;</span>
<span class="sx">    &lt;%=</span><span class="w"> </span><span class="n">content_for</span><span class="p">(</span><span class="ss">:head</span><span class="p">)</span><span class="w"> </span><span class="sx">%&gt;</span>
<span class="sx">  &lt;/head&gt;</span>
</code></pre></div></p>
<h5 id="running-the-webpack-server">Running the Webpack server</h5>
<p>Release 2.0 uses the <a href="https://rubygems.org/gems/foreman/">Foreman Gem</a> in order to run both the Rails server and Webpack development server in parallel.  This is useful for development environments where the Webpack dev. server listens for source file changes, and automatically recompiles packs.  A file (named <code>Procfile</code>) within the root path of the application should be created with the following content:
  <div class="highlight"><pre><span></span><code>rails: bin/rails server --port=3000
webpack: bin/webpack-dev-server
</code></pre></div></p>
<p>This can then be executed using <code>bundle exec foreman start</code>.</p>
<p>For deployments to testing, staging, or production environments, it is perhaps preferred to simply precompile the Webpack builds.  This can be achieved with the task <code>bundle exec rails webpacker:compile</code></p>
<h3 id="geoblacklight-updates">GeoBlacklight updates</h3>
<h4 id="dropped-leaflet-rails-vendorized-a-rails-savvy-leafletjs-file">Dropped leaflet-rails; Vendorized a rails-savvy leaflet.js file</h4>
<p>To fix a Leaflet FeatureLayer asset path issue, we decided to remove leaflet-rails as a gem dependency. Instead of the gem, we're now using a slightly modified leaflet.js file in vendor/javascripts.</p>
<p>For existing GBL installations, you will need to <a href="https://github.com/geoblacklight/geoblacklight/commit/c65dab54a8b59f7a4a4c7c964fb2f21fd32657bb#diff-75f2c11ee17f1317e0fe69daff3dddb7">remove the require leaflet-rails statement</a> from lib/geoblacklight/engine.rb to avoid an error upon application restart.</p>
<h4 id="added-spatial-search-bbox-overlapratio-relevancy-option">Added Spatial Search BBox overlapRatio Relevancy Option</h4>
<p>A new Settings constant was added to provide optional support for <a href="https://lucene.apache.org/solr/guide/7_6/spatial-search.html#bboxfield">Solr's BBoxField overlapRatio</a> relevancy boosting within spatial searches.</p>
<p>For existing GBL installations, you will need to <a href="https://github.com/geoblacklight/geoblacklight/blob/master/lib/generators/geoblacklight/templates/settings.yml#L16-L17">add the Settings.OVERLAP_RATIO_BOOST</a> setting to your settings.yml file.</p>
<div class="highlight"><pre><span></span><code>    # The bf boost value for overlap ratio
    OVERLAP_RATIO_BOOST: &#39;2&#39;
</code></pre></div>
<p>If this option has a value, the boost will be <a href="https://github.com/geoblacklight/geoblacklight/blob/master/app/models/concerns/geoblacklight/spatial_search_behavior.rb#L22-L26">appended to the spatial search</a> like so:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="no">Settings</span><span class="o">.</span><span class="n">OVERLAP_RATIO_BOOST</span>
<span class="w">      </span><span class="n">solr_params</span><span class="o">[</span><span class="ss">:overlap</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="s2">&quot;{!field uf=* defType=lucene f=solr_bboxtype score=overlapRatio}Intersects(</span><span class="si">#{</span><span class="n">envelope_bounds</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="w">      </span><span class="n">solr_params</span><span class="o">[</span><span class="ss">:bf</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;$overlap^</span><span class="si">#{</span><span class="no">Settings</span><span class="o">.</span><span class="n">OVERLAP_RATIO_BOOST</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">end</span>
</code></pre></div>
<h4 id="relevancy-is-best-tuned-locally">Relevancy is Best Tuned Locally</h4>
<p>Everyone's idea of relevancy is different. The default boost value here ("2") might not be the best for your collection or user needs. Please adjust this relevancy boost as necessary to ensure best results for your GBL install.</p>
<h4 id="homepage">Homepage</h4>
<p>The <code>_homepage_text.html.erb</code> view partial has been updated to use a view component for rendering the featured facets feature. You should update any local customizations to this file to use the components.</p>
<hr />






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.follow", {"index_page": "tags.md", "tags": {}}], "search": "../../../assets/javascripts/workers/search.6c7302c4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.10c6cd24.min.js"></script>
      
    
  </body>
</html>