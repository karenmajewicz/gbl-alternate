
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Jack Reed">
      
      
        <link rel="canonical" href="https://karenmajewicz.github.io/gbl-mkdocs/blog/2016-01-23-using-packer-to-create-a-development-virtual-machine/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.14">
    
    
      
        <title>Using Packer to create a development virtual machine for GeoBlacklight - GBL MkDocs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/neoteroi-cards.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="GBL MkDocs" class="md-header__button md-logo" aria-label="GBL MkDocs" data-md-component="logo">
      
  <img src="../../images/geoblacklight-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GBL MkDocs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using Packer to create a development virtual machine for GeoBlacklight
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../showcase/" class="md-tabs__link">
      Showcase
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../connect/" class="md-tabs__link">
      Connect
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../" class="md-tabs__link">
      Blog
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://geoblacklight.org/docs" class="md-tabs__link">
      Documentation
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="GBL MkDocs" class="md-nav__button md-logo" aria-label="GBL MkDocs" data-md-component="logo">
      
  <img src="../../images/geoblacklight-logo.png" alt="logo">

    </a>
    GBL MkDocs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../showcase/" class="md-nav__link">
        Showcase
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../connect/" class="md-nav__link">
        Connect
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Blog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://geoblacklight.org/docs" class="md-nav__link">
        Documentation
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-geoblacklight-packer-template" class="md-nav__link">
    Using the GeoBlacklight Packer template
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploring-the-packer-template" class="md-nav__link">
    Exploring the Packer template
  </a>
  
    <nav class="md-nav" aria-label="Exploring the Packer template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rubysh" class="md-nav__link">
    ruby.sh
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#railssh" class="md-nav__link">
    rails.sh
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geoblacklightsh" class="md-nav__link">
    geoblacklight.sh
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opengeosuitesh" class="md-nav__link">
    opengeosuite.sh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-vagrant-box" class="md-nav__link">
    Creating the Vagrant box
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  




  <h1>Using Packer to create a development virtual machine for GeoBlacklight</h1>

<p>When we run the GeoBlacklight workshop, we provide attendees with a VirtualBox virtual machine (vm) so that they can participate without having download software. Having attendees connect to the internet to download large files doesn't always work in conference environments. To keep up to date with software dependencies we have rebuilt this virtual machine several times. Recently, the process for creating and updating the virtual machine has been automated using <a href="https://www.packer.io/downloads.html">Packer</a>. From Packer's website:</p>
<blockquote>
<p>Packer is a tool for creating machine and container images for multiple platforms from a single source configuration.</p>
</blockquote>
<p>This tutorial outlines how we create the GeoBlacklight workshop vm, so that others can create this virtual machine from scratch. This tutorial could also be adapted to <a href="https://www.packer.io/intro/platforms.html">create an image</a> for Amazon EC2, Digital Ocean, Docker, and others.</p>
<h3 id="getting-started">Getting started</h3>
<p>To get started, you will need to install several pieces of software that our Packer template will use. Go ahead and install this software for your system.</p>
<p>Required software:</p>
<ul>
<li>Packer <a href="https://www.packer.io/downloads.html">installation</a></li>
<li>VirtualBox <a href="https://www.virtualbox.org/wiki/Downloads">download</a></li>
<li>Vagrant <a href="https://www.vagrantup.com/downloads.html">download</a></li>
</ul>
<p>Once you have installed all of the software, make sure that you have Packer available on your path.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>packer<span class="w"> </span>-v
<span class="m">0</span>.8.6
</code></pre></div>
<h3 id="using-the-geoblacklight-packer-template">Using the GeoBlacklight Packer template</h3>
<p>Next, you will need to clone down the <a href="https://github.com/mejackreed/packer-templates">Packer template</a> that was created for the GeoBlacklight Workshop from <a href="https://github.com/mejackreed/packer-templates">https://github.com/mejackreed/packer-templates</a>.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/mejackreed/packer-templates.git
</code></pre></div>
<p>Next change directory (<code>cd</code>) into the git repository you just cloned.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>packer-templates
</code></pre></div>
<p>And checkout the <code>geoblacklight</code> branch.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>geoblacklight
</code></pre></div>
<p>Finally, change directory (<code>cd</code>) into the <code>ubuntu-16.04.3</code> directory. This is the image I based the GeoBlacklight Workshop image on.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>ubuntu-16.04.3
</code></pre></div>
<div class='flash-alert'>
  It should be noted that I opted for the 32-bit version of this release of Ubuntu for maximum compatibility. You may want to change the <a href="https://github.com/mejackreed/packer-templates/blob/geoblacklight/ubuntu-16.04.3/template.json#L84">version of Ubuntu</a> used and thus you must also update <a href="https://github.com/mejackreed/packer-templates/blob/geoblacklight/ubuntu-16.04.3/template.json#L82">the checksum</a>.
</div>

<h3 id="exploring-the-packer-template">Exploring the Packer template</h3>
<p>The <a href="https://github.com/mejackreed/packer-templates/blob/geoblacklight/ubuntu-16.04.3/template.json"><code>template.json</code></a> file is where Packer takes its directions from. I won't go through everything in this file, but I will point out some of the customizations I made for the GeoBlacklight workshop.</p>
<p>The major customizations added, were the addition of four scripts that run during creation.</p>
<h4 id="rubysh"><a href="https://github.com/mejackreed/packer-templates/blob/geoblacklight/ubuntu-16.04.3/scripts/ruby.sh"><code>ruby.sh</code></a></h4>
<p>Installs rbenv, Ruby, bundler, and specifies no rdoc documentation.</p>
<h4 id="railssh"><a href="https://github.com/mejackreed/packer-templates/blob/geoblacklight/ubuntu-16.04.3/scripts/rails.sh"><code>rails.sh</code></a></h4>
<p>Installs nodejs and Ruby on Rails.</p>
<h4 id="geoblacklightsh"><a href="https://github.com/mejackreed/packer-templates/blob/geoblacklight/ubuntu-16.04.3/scripts/geoblacklight.sh"><code>geoblacklight.sh</code></a></h4>
<p>Creates a GeoBlacklight application and downloads and configures jetty/solr.</p>
<h4 id="opengeosuitesh"><a href="https://github.com/mejackreed/packer-templates/blob/geoblacklight/ubuntu-16.04.3/scripts/opengeosuite.sh"><code>opengeosuite.sh</code></a></h4>
<p>Installs OpenGeoSuite.</p>
<h3 id="creating-the-vagrant-box">Creating the Vagrant box</h3>
<p>You can modify any of these scripts to meet your customization needs. After doing so, you will want to create your VirtualBox vm. To do so run the following command from the <code>ubuntu-16.04.3</code> directory:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>packer<span class="w"> </span>build<span class="w"> </span>template.json
</code></pre></div>
<p>This command will take a while so it might be best to go get a coffee. What the command is doing:</p>
<ul>
<li>Downloading a fresh copy of Ubuntu</li>
<li>Creating a VirtualBox image with that copy of Ubuntu</li>
<li>Updating the vm's packages</li>
<li>Installing our custom software</li>
</ul>
<p>After the command finishes you should have your virtual machine box waiting for you in the same directory.</p>
<p>To create a <code>Vagrantfile</code> to use with this box:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>vagrant<span class="w"> </span>init<span class="w"> </span>ubuntu-14-04-3-x32-virtualbox.box
</code></pre></div>
<p>Now you can start up your fresh box using:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>vagrant<span class="w"> </span>up
</code></pre></div>
<p>And to ssh in</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>vagrant<span class="w"> </span>ssh
</code></pre></div>
<h3 id="conclusion">Conclusion</h3>
<p>I hope this tutorial is useful to others who run technical workshops. It can sometimes be painful in trying to support workshops on multiple platforms with limited network connectivity. This workflow of using Packer, Vagrant, and VirtualBox has been successful for us.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.follow", {"index_page": "tags.md", "tags": {}}], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>